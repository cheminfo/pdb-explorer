/*! jsNMR 1.1.1 | (c) 2014 Norman Pellet | http://github.com/NPellet/jsNMR/copyright.txt */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a):b(a)}(window,function(a){var b=function(a,b,c,d){function e(a,b,d){var e=[];for(var f in b)e.push($.get(b[f]).then(function(a){return c.convert(a)}));a.divLoading||(a.divLoading=$("<div />").css({width:a.getDom().width(),height:a.getDom().height(),position:"absolute",backgroundColor:"rgba(200, 200, 200, 0.5)",textAlign:"center",lineHeight:a.getDom().height()+"px",fontSize:"2em",border:"1px solid #c0c0c0"}).html("Loading..."),a.getDom().prepend(a.divLoading)),a.loading=a.loading||0,a.loading++,$.when.apply($,e).then(function(){var c=0;for(f in b)b[f]=arguments[c],c++;a.loading--,0==a.loading&&(a.divLoading.remove(),a.divLoading=!1),a.series.push(b),a.loaded(b,d,"a"+Math.random())})}function f(a,b,c){for(var d=0,e=0,g=a.integrals[b].length;g>e;e++)d=Math.max(d,a.integrals[b][e].lastSum);for(var e=0,g=a.integrals[b].length;g>e;e++)a.integrals[b][e].ratio=Math.abs(0==d?1:a.integrals[b][e].lastSum/d),a.integrals[b][e].setPosition(),a.integrals[b][e].data.label[0].text=a.integralBasis?Math.round(a.integrals[b][e].lastSum/a.integralBasis*100)/100:1,a.integrals[b][e].setLabelPosition(0),a.integrals[b][e].setLabelText(0);a.isSymmetric()&&!c&&f(a,l(a,b),!0)}function g(a,b,c){var d=b.getFromData("pos"),e=b.getFromData("pos2"),f=c.getFromData("pos"),g=c.getFromData("pos2");f.x=d.y,f.y=d.x,g.x=e.y,g.y=e.x}function h(a,b,c){if(c.setSerie(a.graphs[b].selectedSerie?a.graphs[b].selectedSerie:a.graphs[b].getSerie(0)),n(a,b,c).then(function(a){a.setSerie(c.getSerie()),c.integral=a,a.data.pos=c.getFromData("pos"),a.data.pos2=c.getFromData("pos2"),a.originalShape=c}),a.isSymmetric()){var d=l(a,b);m(a,d).then(function(b){c.syncTo=b,b.syncTo=c,b.setSerie(a.graphs[d].selectedSerie),b.data.pos={},b.data.pos2={},b.draw(),g(a,c,c.syncTo),b.redrawImpl(),n(a,d).then(function(a){b.integral=a,a.setSerie(b.getSerie()),a.data.pos=b.getFromData("pos"),a.data.pos2=b.getFromData("pos2"),a.originalShape=b})})}}function i(a,b,c){c.integral&&(c.integral.setPosition(),c.syncTo&&(g(a,c,c.syncTo),c.syncTo.redrawImpl(),c.syncTo.integral&&c.syncTo.integral.setPosition()),f(a,b))}function j(a,b,c){c.integral&&(c.integral.setPosition(),c.syncTo&&(g(a,c,c.syncTo),c.syncTo.redrawImpl(),c.syncTo.integral.setPosition()),f(a,b))}function k(a,b,c){if(c.integral){var d=c.integral;c.integral=!1,d.originalShape=!1,d._inDom&&d.kill(),a.integrals[b].splice(a.integrals[b].indexOf(d),1)}c.syncTo&&(c.syncTo.kill(),a.integrals[l(b)].splice(a.integrals[l(a,b)].indexOf(c.syncTo.integral),1)),f(a,b)}function l(a,b){return"x"==b?"y":"y"==b?"x":console.error("Mode not recognized")}function m(a,b){var c=a.graphs[b].newShape($.extend(!0,{},a.nmrSignal1dOptions[b]),{});return c||(c=$.Deferred().reject()),c}function n(a,b){var c=a.graphs[b].newShape($.extend(!0,{},a.nmrIntegralOptions[b]),{});return c?c.then(function(c){return a.integrals[b].push(c),c.draw(),c}):c=$.Deferred().reject(),c}function o(a,b){return{shapeOptions:{onCreate:function(){h(a,b,this)},onResize:function(){i(a,b,this)},onMove:function(){j(a,b,this)}}}}function p(a,b,c){var d;(d=a.graphs[b].getSerie(c))&&d.kill(),a.graphs[b].redraw(),a.graphs[b].drawSeries()}function q(a){switch(a.getMode()){case"1d":a.options.dom.append("<div />"),a.makeGraphs1D();break;case"2d":a.options.dom.append('<div class="nmr-table-wrapper"><div class="nmr-2d-map" style="width: 150px; height: 150px; position: absolute; right: 0; bottom: 0"></div><table cellpadding="0" cellspacing="0" class="nmr-wrapper"><tr><td></td><td class="nmr-1d nmr-1d-x nmr-main" style="width: 500px; height: 150px;"></td></tr><tr class="nmr-main"><td class="nmr-1d nmr-1d-y"style="height: 500px; width: 150px;"></td><td class="nmr-2d" style="height: 500px; width: 500px;"></td></tr></table></div>'),a.makeGraphs2D()}}function r(a,b){var c=document.createElement("div");c.setAttribute("style","position: absolute;");var e=new d({maxBondLengthAverage:40});c.appendChild(e.getDom()),e.resize(150,100),e.setDataFromJSONFile(a).then(function(){e.render()}),b.prepend(c)}var s={mode:"1d",molecule:!1,urls:{}},t=function(a){switch(this.options=$.extend(!0,{},s,a),this.series=[],this.minimapClip,this.nmrIntegralOptions={x:{type:"nmrintegral",fillColor:"transparent",strokeColor:"rgba(100, 0, 0, 0.5)",strokeWidth:"1px",label:{position:{},text:1,color:"red",anchor:"middle"},shapeOptions:{locked:!0}}},this.isSymmetric()&&(this.nmrIntegralOptions.y=$.extend(!0,{},this.nmrIntegralOptions.x),this.nmrIntegralOptions.y.shapeOptions.axis="y"),this.nmrSignal1dOptions={x:{url:"src/shape.1dnmr",strokeColor:"green",strokeWidth:2,shapeOptions:{horizontal:!0,forcedCoords:{y:function(a){return 20+5*a.serie.getIndex()+"px"}},bindable:!0,axis:"x"}}},this.isSymmetric()&&(this.nmrSignal1dOptions.y=$.extend(!0,{},this.nmrSignal1dOptions.x),this.nmrSignal1dOptions.y.shapeOptions.axis="y"),this.nmrSignal1dOptions.x=$.extend(!0,{},this.nmrSignal1dOptions.x,o(this,"x")),this.nmrSignal1dOptions.y=$.extend(!0,{},this.nmrSignal1dOptions.x,o(this,"y")),this.nmrSignal2dOptions={url:"src/shape.2dnmr",strokeColor:"green",strokeWidth:2,shapeOptions:{horizontal:!0,forcedCoords:{y:"20px"},bindable:!0,axis:"x"}},this.options.mode){case"2d":this.graphs={x:null,y:null,_2d:null},this.integrals={x:[],y:[],_2d:[]};break;case"1d":this.graphs={x:null},this.integrals={x:[]}}switch(q(this),this.options.mode){case"2d":break;case"1d":this.legend=this.graphs.x.makeLegend({frame:!0,frameWidth:2,frameColor:"grey",movable:!0,backgroundColor:"white"}),this.legend.setPosition({x:"300px",y:"40px"},"right")}},u={urls:{}};return t.prototype.load=function(a){var a=$.extend(!0,{},u,a),b={};switch(this.options.mode){case"2d":a.urls.twoD=a.urls.twoD||a.urls.url,a.urls.x=a.urls.x||a.urls.oneD,a.urls.y=a.urls.y||a.urls.oneD||(a.symmetric?a.urls.x:!1),b.twoD=a.urls.twoD,a.urls.x&&(b.x=a.urls.x),a.urls.y?b.y=a.urls.y:this.isSymmetric()&&(b.y=b.x);break;case"1d":a.urls.oneD=a.url||a.urls.oneD||a.urls.x,b.x=a.urls.oneD}e(this,b,a),a.molecule&&(r(a.molecule,this.options.dom),new Assignation(this.options.dom,this.graphs))},t.prototype.isSymmetric=function(){return this.options.symmetric||!1},t.prototype.getMode=function(){return this.options.mode},t.prototype.getDom=function(){return this.options.dom},t.prototype.resize1DTo=function(a,b){this.graphs.x.resize(a,b),this.graphs.x.drawSeries()},t.prototype.resize2DTo=function(a,b){this.options.dom.find(".nmr-1d-y").css({height:b-150,width:150}),this.graphs.y.resize(150,b-150),this.options.dom.find(".nmr-1d-x").css({width:a-150,height:150}),this.graphs.x.resize(a-150,150),this.options.dom.find(".nmr-2d").css({width:a-150,height:b-150}),this.graphs._2d.resize(a-150,b-150)},t.prototype.setSerie2DX=function(a,b,c){if(!this.graphs.x.getSerie(a)){var d=this.graphs.x.newSerie(a,$.extend({useSlots:!0},c)).setLabel("My serie").autoAxis().setData(b);d.getYAxis().setDisplay(!1).togglePrimaryGrid(!1).toggleSecondaryGrid(!1),d.getXAxis().flip(!0).setLabel("ppm").togglePrimaryGrid(!1).toggleSecondaryGrid(!1).setTickPosition("outside"),d.XIsMonotoneous(),c.lineColor&&d.setLineColor(c.lineColor),c.lineWidth&&d.setLineWidth(c.lineWidth),c.setLineStyle&&d.setLineStyle(c.lineStyle)}},t.prototype.setSerie2DY=function(a,b,c){if(!this.graphs.y.getSerie(a)){var d=this.graphs.y.newSerie(a,$.extend({useSlots:!0,flip:!0},c)).setLabel("My serie").setXAxis(this.graphs.y.getBottomAxis()).setYAxis(this.graphs.y.getRightAxis()).setData(b);d.getYAxis().setLabel("ppm").togglePrimaryGrid(!1).toggleSecondaryGrid(!1).flip(!0).setTickPosition("outside"),d.getXAxis().togglePrimaryGrid(!1).toggleSecondaryGrid(!1).setDisplay(!1).flip(!0),d.XIsMonotoneous(),c.lineColor&&d.setLineColor(c.lineColor),c.lineWidth&&d.setLineWidth(c.lineWidth),c.setLineStyle&&d.setLineStyle(c.lineStyle)}},t.prototype.setSerie2D=function(a,b,c){if(!this.graphs._2d.getSerie(a)){var d=this.graphs._2d.newSerie(a,c,"contour").setLabel("My serie").autoAxis().setData(b);c.lineColor&&d.setLineColor(c.lineColor),c.twoDColor&&d.setDynamicColor(c.twoDColor),c.twoDNegative&&d.setNegative(!0),d.setShapeZoom(this.shapeZoom),this.shapeZoom.setSerie(d),this.shapeZoom.addSerie(d),c.lineWidth&&d.setLineWidth(c.lineWidth),c.setLineStyle&&d.setLineStyle(c.lineStyle)}},t.prototype.removeSerie2DX=function(a){p(this,"x",a)},t.prototype.removeSerie2DY=function(a){p(this,"y",a)},t.prototype.removeSerie2D=function(a){p(this,"_2d",a)},t.prototype.removeSerieX=function(a){p(this,"x",a)},t.prototype.redrawAll2D=function(){this.graphs.y.updateAxes(),this.graphs.x.updateAxes(),this.graphs.y.redraw(),this.graphs.y.drawSeries(),this.graphs.x.redraw(),this.graphs.x.drawSeries(),this.graphs._2d.redraw(),this.graphs._2d.drawSeries(),this.graphs._2d.getXAxis().forceMin(this.graphs.x.getXAxis().getMinValue()),this.graphs._2d.getXAxis().forceMax(this.graphs.x.getXAxis().getMaxValue()),this.graphs._2d.getYAxis().forceMin(this.graphs.y.getRightAxis().getMinValue()),this.graphs._2d.getYAxis().forceMax(this.graphs.y.getRightAxis().getMaxValue())},t.prototype.setSerieX=function(a,b,c){this.graphs.x.getSerie(a)&&(this.graphs.x.getSerie(a).kill(),this.graphs.x.removeShapes(),this.integralBasis=!1);var d=this.graphs.x.newSerie(a,$.extend({useSlots:!0},c)).setLabel("My serie").autoAxis().setData(b).XIsMonotoneous();c.lineColor&&d.setLineColor(c.lineColor),c.lineWidth&&d.setLineWidth(c.lineWidth),c.setLineStyle&&d.setLineStyle(c.lineStyle),d.XIsMonotoneous(),d.getYAxis().setDisplay(!1).togglePrimaryGrid(!1).toggleSecondaryGrid(!1),d.getXAxis().flip(!0).setLabel("ppm").togglePrimaryGrid(!1).toggleSecondaryGrid(!1).setTickPosition("outside"),this.graphs.x.autoscaleAxes(),this.graphs.x.drawSeries()},t.prototype.loaded=function(a,b,c){switch(this.getMode()){case"1d":this.setSerieX(c,spectra.x.spectra[0].data[0],{label:"SomeLabel"});break;case"2d":this.setSerie2DX(c,a.x.spectra[0].data[0],b),this.setSerie2DY(c,a.y.spectra[0].data[0],b),this.setSerie2D(c,a.twoD.contourLines,b),this.redrawAll2D()}},t.prototype.makeGraphs2D=function(){var b=this;this.graphs._2d=new a(this.getDom().find(".nmr-2d").get(0),{close:{left:!1,top:!1,right:!1},paddingBottom:0,paddingTop:0,paddingLeft:0,paddingRight:0,onAnnotationChange:function(a,b){if("rect"==a.type){var c=a.pos;c.x=(c.x+a.pos2.x)/2,c.y=(c.y+a.pos2.y)/2,this.newShape({type:"cross",pos:c,strokeColor:"red",strokeWidth:3,shapeOptions:{length:20,locked:!0}}).then(function(a){a.draw(),a.redrawImpl()}),b.kill()}},plugins:{"graph.plugin.zoom":{zoomMode:"xy",onZoomStart:function(a,c,d,e){b.graphs.x._pluginExecute("graph.plugin.zoom","onMouseDown",[b.graphs.x,c,d,e,!0]),b.graphs.y._pluginExecute("graph.plugin.zoom","onMouseDown",[b.graphs.y,c,d,e,!0])},onZoomMove:function(a,c,d,e){b.graphs.x._pluginExecute("graph.plugin.zoom","onMouseMove",[b.graphs.x,c,d,e,!0]),b.graphs.y._pluginExecute("graph.plugin.zoom","onMouseMove",[b.graphs.y,c,d,e,!0])},onZoomEnd:function(a,c,d,e,f,g,h){b.graphs.x._pluginExecute("graph.plugin.zoom","onMouseUp",[b.graphs.x,c,d,e,!0]),b.graphs.y._pluginExecute("graph.plugin.zoom","onMouseUp",[b.graphs.y,c,d,e,!0]);var c=a.getBottomAxis().getVal(g),i=a.getBottomAxis().getVal(c),d=a.getLeftAxis().getVal(h),j=a.getLeftAxis().getVal(d);b.options.minimap&&(b.minimapClip.data.pos={x:c,y:d},b.minimapClip.data.pos2={x:i,y:j},b.minimapClip.redraw())},onDblClick:function(a,c,d,e){b.graphs.y._pluginExecute("graph.plugin.zoom","onDblClick",[b.graphs.y,a,c,{mode:"total"},e,!0]),b.graphs.x._pluginExecute("graph.plugin.zoom","onDblClick",[b.graphs.x,a,c,{mode:"total"},e,!0])}},"graph.plugin.shape":{type:"rect",fillColor:"rgba(100, 0, 0, 0.3)",shapeOptions:{bindable:!1}}},dblclick:{type:"plugin",plugin:"graph.plugin.zoom",options:{mode:"total"}},pluginAction:{"graph.plugin.zoom":{shift:!1,ctrl:!1},"graph.plugin.shape":{shift:!0,ctrl:!1}},wheel:{type:"toSeries"},onSelectSerie:function(a){b.graphs.x.selectSerie(b.graphs.x.getSerie(a.getName())),b.graphs.y.selectSerie(b.graphs.y.getSerie(a.getName()))},onUnselectSerie:function(a){b.graphs.x.unselectSerie(b.graphs.x.getSerie(a.getName())),b.graphs.y.unselectSerie(b.graphs.y.getSerie(a.getName()))}}),this.options.minimap&&$(".nmr-2d-map").each(function(){b.graphs["_2d-minimap"]=new a(this,{});var c;$.when(b.graphs["_2d-minimap"].newShape({pos:{x:"min",y:"min"},pos2:{x:"max",y:"max"},type:"rect",fillColor:"rgba( 100, 100, 100, 0.4 )"}).then(function(a){c=a,a.draw(),a.redraw(),a.setSelectable(!1),a.setMovable(!1)}),b.graphs["_2d-minimap"].newShape({pos:{x:"min",y:"min"},pos2:{x:"max",y:"max"},type:"rect",fillColor:"transparent",shapeOptions:{masker:!0}}).then(function(a){a.staticHandles(!0),b.minimapClip=a,a.draw(),a.redraw()})).then(function(){c.maskWith(b.minimapClip)}),b.graphs["_2d-minimap"].shapeHandlers.onChange.push(function(a){if(a==b.minimapClip){var c=b.minimapClip.data.pos,d=b.minimapClip.data.pos2;if(c.x=b.graphs["_2d-minimap"].getValPosition(c.x,a.serie.getXAxis()),c.y=b.graphs["_2d-minimap"].getValPosition(c.y,a.serie.getYAxis()),d.x=b.graphs["_2d-minimap"].getValPosition(d.x,a.serie.getXAxis()),d.y=b.graphs["_2d-minimap"].getValPosition(d.y,a.serie.getYAxis()),isNaN(c.x)||isNaN(d.x)||isNaN(c.y)||isNaN(d.y))return;b.graphs._2d.getXAxis().zoom(c.x,d.x),b.graphs._2d.getYAxis().zoom(c.y,d.y),b.graphs._2d.redraw(),b.graphs._2d.drawSeries(),b.graphs.x.getXAxis().zoom(c.x,d.x),b.graphs.x.redraw(),b.graphs.x.drawSeries(),b.graphs.y.getYAxis().zoom(c.y,d.y),b.graphs.y.redraw(),b.graphs.y.drawSeries()}}),b.graphs["_2d-minimap"].getXAxis().setLabel("ppm").togglePrimaryGrid(!1).toggleSecondaryGrid(!1).setDisplay(!1).flip(!0),b.graphs["_2d-minimap"].getYAxis().togglePrimaryGrid(!1).toggleSecondaryGrid(!1).setDisplay(!1).flip(!0),b.graphs["_2d-minimap"].getXAxis().setAxisDataSpacing(0),b.graphs["_2d-minimap"].getYAxis().setAxisDataSpacing(0)}),b.graphs._2d.getXAxis().setLabel("ppm").togglePrimaryGrid(!1).toggleSecondaryGrid(!1).setDisplay(!1).flip(!0),b.graphs._2d.getYAxis().togglePrimaryGrid(!1).toggleSecondaryGrid(!1).setDisplay(!1).flip(!0),b.graphs._2d.getXAxis().setAxisDataSpacing(0),b.graphs._2d.getYAxis().setAxisDataSpacing(0);var c=this.graphs._2d.makeLegend({frame:!0,frameColor:"grey",frameWidth:1,movable:!0});c.setPosition({x:"20px",y:"20px"}),this.graphs._2d.newShape({type:"zoom2d",pos:{x:"min",dx:"-210px",y:"max",dy:"-130px"}}).then(function(a){a.draw(),a.redraw(),b.shapeZoom=a}),this.graphs.x=new a(this.getDom().find(".nmr-1d-x").get(0),{close:{left:!1,top:!1,right:!1},paddingBottom:0,paddingTop:0,paddingLeft:0,paddingRight:0,onAnnotationChange:function(a,c){if(a.url.indexOf("shape.1dnmr")>-1)b.integralBasis||(b.integralBasis=c.integral.lastSum);else if("nmrintegral"==a.type&&b.integralBasis){var d=parseFloat(c.data.label[0].text);0!=d&&(b.integralBasis=c.lastSum/d)}f(b,"x"),b.isSymmetric()&&f(b,"y")},plugins:{"graph.plugin.zoom":{zoomMode:"x",onZoomStart:function(a,c,d,e){b.graphs._2d._pluginExecute("graph.plugin.zoom","onMouseDown",[b.graphs._2d,c,void 0,e,!0])},onZoomMove:function(a,c,d,e){b.graphs._2d._pluginExecute("graph.plugin.zoom","onMouseMove",[b.graphs._2d,c,void 0,e,!0])},onZoomEnd:function(){var a=b.graphs.x.getXAxis(),c=a.getActualMin(),d=a.getActualMax();b.graphs._2d._applyToAxes("_doZoomVal",[c,d],!0,!1),b.graphs._2d.redraw(),b.graphs._2d.drawSeries(),b.graphs._2d._pluginExecute("graph.plugin.zoom","removeZone",[])},onDblClick:function(a,c,d,e){b.graphs._2d._pluginExecute("graph.plugin.zoom","onDblClick",[b.graphs._2d,a,c,{mode:"xtotal"},e,!0])}},"graph.plugin.shape":b.nmrSignal1dOptions.x},dblclick:{type:"plugin",plugin:"graph.plugin.zoom",options:{mode:"total"}},pluginAction:{"graph.plugin.zoom":{shift:!1,ctrl:!1},"graph.plugin.shape":{shift:!0,ctrl:!1}},wheel:{type:"plugin",plugin:"graph.plugin.zoom",options:{direction:"x"}},onBeforeNewShape:function(){return b.graphs._2d.selectedSerie?void 0:!1}}),b.graphs.x.shapeHandlers.onCreated.push(function(a){a.data.url.indexOf("src/shape.1dnmr")>-1&&(a.set("strokeColor",a.serie.getLineColor()),a.setStrokeColor())}),this.graphs.y=new a(this.getDom().find(".nmr-1d-y").get(0),{close:{left:!1,top:!1,right:!1},plugins:{"graph.plugin.zoom":{zoomMode:"y",onZoomStart:function(a,c,d,e){b.graphs._2d._pluginExecute("graph.plugin.zoom","onMouseDown",[b.graphs._2d,void 0,d,e,!0])},onZoomMove:function(a,c,d,e){b.graphs._2d._pluginExecute("graph.plugin.zoom","onMouseMove",[b.graphs._2d,void 0,d,e,!0])},onZoomEnd:function(){var a=b.graphs.y.getYAxis(),c=a.getActualMin(),d=a.getActualMax();b.graphs._2d._applyToAxes("_doZoomVal",[c,d],!1,!0),b.graphs._2d.redraw(),b.graphs._2d.drawSeries(),b.graphs._2d._pluginExecute("graph.plugin.zoom","removeZone",[])},onDblClick:function(a,c,d,e){b.graphs._2d._pluginExecute("graph.plugin.zoom","onDblClick",[b.graphs._2d,a,c,{mode:"ytotal"},e,!0])}},"graph.plugin.shape":b.nmrSignal1dOptions.y},dblclick:{type:"plugin",plugin:"graph.plugin.zoom",options:{mode:"total"}},pluginAction:{"graph.plugin.zoom":{shift:!1,ctrl:!1},"graph.plugin.shape":{shift:!0,ctrl:!1}},wheel:{type:"plugin",plugin:"graph.plugin.zoom",options:{direction:"y"}},paddingBottom:0,paddingTop:0,paddingLeft:0,paddingRight:10,onBeforeNewShape:function(){return b.graphs._2d.selectedSerie?void 0:!1}})},t.prototype.makeGraphs1D=function(){var b=this;this.graphs.x=new a(this.getDom().children().get(0),{close:{left:!1,top:!1,right:!1},paddingBottom:0,paddingTop:0,paddingLeft:0,paddingRight:0,onAnnotationChange:function(a,c){if(a.url&&a.url.indexOf("shape.1dnmr")>-1)b.integralBasis||(b.integralBasis=c.integral.lastSum);else if("nmrintegral"==a.type&&b.integralBasis){var d=parseFloat(c.data.label[0].text);0!=d&&(b.integralBasis=c.lastSum/d)}f(b,"x")},plugins:{"graph.plugin.zoom":{zoomMode:"x"},"graph.plugin.shape":this.nmrSignal1dOptions.x},dblclick:{type:"plugin",plugin:"graph.plugin.zoom",options:{mode:"total"}},wheel:{type:"plugin",plugin:"graph.plugin.zoom",options:{direction:"x"}},pluginAction:{"graph.plugin.zoom":{shift:!1,ctrl:!1},"graph.plugin.shape":{shift:!0,ctrl:!1}},onBeforeNewShape:function(){return!this.selectedSerie&&this.series.length>1?!1:void 0}}),this.graphs.x.setHeight(300),this.graphs.x.shapeHandlers.onRemoved.push(function(a){a.integral?k(b,"x",a):a.originalShape&&a.originalShape.kill()}),this.graphs.x.redraw(),this.graphs.x.drawSeries()},t};if("function"==typeof define&&define.amd)define(["graph","assignation","jcampconverter","lib/components/VisuMol/src/molecule"],function(a,c,d,e){return b(a,c,d,e)});else if(a){if(!(a.Graph&&a.Assignation&&a.JcampConverter))throw"Graph, Attribution or Jcamp is not defined";a.NMRHandler=b(a.Graph,a.Assignation,a.JcampConverter,a.Molecule)}}),function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a):b(a)}("undefined"!=typeof window?window:this,function(a){"use strict";var b=function(a){return function(b,c){var d,e=!1,f=!1,g=!1,h=[],i=function(b,g){if(g.shiftKey){for(var h in c)c[h].lockShapes();e=!0,f=b,g.preventDefault(),g.stopPropagation()}var i=a(b).position(),j=parseFloat(b.getAttribute("width")||0),k=parseFloat(b.getAttribute("height")||0),l=parseFloat(b.getAttribute("x2")||0),m=parseFloat(b.getAttribute("y2")||0),n=parseFloat(b.getAttribute("x1")||0),o=parseFloat(b.getAttribute("y1")||0),p=i.left+j/2+Math.abs(l-n)/2,q=i.top+k/2+Math.abs(m-o)/2;d.setAttribute("display","block"),d.setAttribute("x1",p),d.setAttribute("x2",p),d.setAttribute("y1",q),d.setAttribute("y2",q)},j=function(a,b){if(e){var f=b.target;d.setAttribute("display","none"),f.classList.contains("bindable")?(g=b.target,e=!1,o()):e=!1;for(var h in c)c[h].unlockShapes()}},k=function(a){e&&(d.setAttribute("x2",a.clientX),d.setAttribute("y2",a.clientY))},l=function(a){n("highlight",a)},m=function(a){n("unhighlight",a)},n=function(a,b){for(var c=0,d=h.length;d>c;c++)(h[c][0]==b||h[c][1]==b)&&(h[c][0].element?h[c][0].element[a]():console.log("Manual"),h[c][1].element?h[c][1].element[a]():console.log("Manual"))},o=function(){h.push([f,g]),f=null,g=null},p=function(){b.on("mousedown",".bindable",function(a){i(this,a)}),b.on("mouseover",".bindable",function(){l(this)}),b.on("mouseout",".bindable",function(){m(this)}),b.on("mouseup",function(a){j(this,a)}),b.on("mousemove",function(a){k(a)})},q="http://www.w3.org/2000/svg",r=document.createElementNS(q,"svg");r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),r.setAttribute("xmlns",q),r.setAttribute("style","position: absolute"),r.setAttribute("width",b.width()),r.setAttribute("height",b.height()),r.setAttribute("pointer-events","none"),d=document.createElementNS(q,"line"),d.setAttribute("stroke","black"),r.appendChild(d),b.prepend(r),p()}};if("function"==typeof define&&define.amd)define(["jquery"],function(a){return b(a)});else if(a){if(!a.jQuery)throw"jQuery has not been loaded. Abort assignation initialization.";a.Assignation=b(a.jQuery)}});