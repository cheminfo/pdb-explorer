{
  "version": "2.28.1-0",
  "grid": {
    "layers": {
      "Default layer": {
        "name": "Default layer"
      },
      "similar": {
        "name": "similar"
      },
      "CalculateSimilarity": {
        "name": "CalculateSimilarity"
      },
      "Initialisation": {
        "name": "Initialisation"
      }
    },
    "xWidth": 10,
    "yHeight": 10
  },
  "modules": [
    {
      "url": "modules/types/display/panzoom/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {}
          ],
          "img": [
            [
              {
                "variable": "png",
                "opacity": "1",
                "order": "1",
                "rendering": "crisp-edges",
                "scaling": "max",
                "rerender": []
              },
              {
                "variable": "representativePin",
                "opacity": "1",
                "order": "4",
                "rendering": "default",
                "scaling": "max",
                "rerender": [
                  "yes"
                ]
              },
              {
                "variable": "svgList",
                "opacity": "1",
                "order": "2",
                "rendering": [
                  "default"
                ],
                "scaling": "max",
                "rerender": [
                  "yes"
                ]
              },
              {
                "variable": "searchPin",
                "opacity": "1",
                "order": "3",
                "rendering": [
                  "default"
                ],
                "scaling": "max",
                "rerender": [
                  "yes"
                ]
              },
              {
                "variable": "droppedPin",
                "opacity": "1",
                "order": "5",
                "rendering": [
                  "default"
                ],
                "scaling": "max",
                "rerender": [
                  "yes"
                ]
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 0,
            "top": 5
          },
          "size": {
            "width": 61,
            "height": 53
          },
          "zIndex": 0,
          "display": true,
          "title": "Double click for full view, scroll to zoom in / out, click and drag to pan",
          "bgColor": [
            0,
            0,
            0,
            1
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 104,
            "top": 23
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            0,
            0,
            0,
            1
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 6,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            0,
            0,
            0,
            1
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 16,
            "top": 83
          },
          "size": {
            "width": 95,
            "height": 87
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            0,
            0,
            0,
            1
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        }
      },
      "id": 1,
      "vars_in": [
        {
          "rel": "picture",
          "name": "png"
        },
        {
          "rel": "picture",
          "name": "representativePin"
        },
        {
          "rel": "picture",
          "name": "svgList"
        },
        {
          "rel": "picture",
          "name": "searchPin"
        },
        {
          "rel": "picture",
          "name": "droppedPin"
        }
      ],
      "actions_in": [
        {
          "rel": "hide",
          "name": "hide"
        },
        {
          "rel": "show",
          "name": "show"
        },
        {
          "rel": "transform",
          "name": "transform"
        }
      ],
      "title": "Double click for full view, scroll to zoom in / out, click and drag to pan",
      "vars_out": [
        {
          "event": "click",
          "rel": "pixel",
          "jpath": [],
          "name": "clickedCell"
        },
        {
          "event": "hover",
          "rel": "pixel",
          "jpath": [],
          "name": "hoverCell"
        }
      ],
      "actions_out": [
        {
          "jpath": []
        }
      ],
      "zindex": 19
    },
    {
      "url": "modules/types/edition/onde/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "hasButton": [
                []
              ],
              "button_text": [
                "Export"
              ],
              "debouncing": [
                500
              ],
              "output": [
                "new"
              ],
              "mode": [
                "schema"
              ],
              "schemaSource": [
                "config"
              ],
              "schema": [
                "{\n    \"type\": \"object\",    \n    \"properties\": {\n        \"pdbs\": {\n            \"type\":\"string\",\n            \"label\":\"Enter a list of PDBs\",\n            \"format\": \"multiline\",\n            \"cols\":55,\n            \"rows\":4\n        }\n    }\n }"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 62,
            "top": 71
          },
          "size": {
            "width": 51,
            "height": 21
          },
          "zIndex": 0,
          "display": true,
          "title": "Lookup a list of PDBs",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 123,
            "top": 74
          },
          "size": {
            "width": 48,
            "height": 23
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 2,
      "vars_in": [
        {}
      ],
      "actions_in": [],
      "title": "Lookup a list of PDBs",
      "vars_out": [
        {
          "event": "onFormSubmit",
          "rel": "outputValue",
          "jpath": [],
          "name": "pdbsList"
        }
      ],
      "actions_out": [
        {
          "jpath": []
        }
      ],
      "zindex": 1
    },
    {
      "url": "modules/types/edition/filter_editor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "script": [
                "var scale = 0.05;\nvar pinWidth = 94;\nvar pinHeight = 128;\nvar imgHeight = 300;\nvar imgWidth = 300;\n\nvar pin = '    <path\\n       id=\"path4127\"\\n       d=\"M 46.977003,126.64334 C 46.693972,125.95584 40.813862,120.20567 36.603071,114.98067 11.655836,81.858372 -16.158365,51.082905 16.319943,13.682837 30.700637,-0.21083367 48.43303,-1.0034227 66.662563,5.4726973 117.9922,35.174601 80.828906,83.627914 56.427079,115.48067 l -9.450076,11.16267 z M 62.417383,75.872046 C 96.654166,51.387445 70.185413,4.2391813 32.569429,19.913013 21.585178,25.769872 16.134954,35.960547 15.944071,47.980664 c -0.524495,11.693153 5.685418,21.471037 15.526227,27.460808 7.055481,3.840074 10.157178,4.533661 18.145697,4.057654 5.177622,-0.308516 8.161127,-1.153847 12.801388,-3.62708 z\"\\n       style=\"fill:#pin-primary-color;fill-opacity:0.98823529\" />\\n    <path\\n       transform=\"matrix(0.87829487,0,0,1.0519028,0.55474126,-6.9952658)\"\\n       d=\"M 41.682107,89.891342 A 51.222816,41.754009 0 0 1 2.2000499,40.607923 51.222816,41.754009 0 0 1 62.407668,8.111826 51.222816,41.754009 0 0 1 102.65487,56.982272 51.222816,41.754009 0 0 1 42.958724,90.099433\"\\n       id=\"path4129\"\\n       style=\"fill:#pin-primary-color;fill-opacity:0.98823529;fill-rule:nonzero;stroke:none\" />\\n    <path\\n       transform=\"translate(0.64534523,0)\"\\n       d=\"M 43.631232,69.128546 A 26.010695,20.991087 0 0 1 23.582437,44.352182 26.010695,20.991087 0 0 1 54.15557,28.015346 26.010695,20.991087 0 0 1 74.592899,52.584095 26.010695,20.991087 0 0 1 44.279492,69.23316\"\\n       id=\"path4131\"\\n       style=\"opacity:0.34016395;fill:black;fill-opacity:0;fill-rule:nonzero;stroke:none\" />\\n    <path\\n       transform=\"translate(0.64534523,0)\"\\n       d=\"M 31.892136,114.28 A 16.655972,11.750445 0 0 1 19.053873,100.41062 16.655972,11.750445 0 0 1 38.631405,91.265547 16.655972,11.750445 0 0 1 51.718468,105.01871 16.655972,11.750445 0 0 1 32.30725,114.33856\"\\n       id=\"path4135\"\\n       style=\"fill:rgb(0,0,128);fill-opacity:0;fill-rule:nonzero;stroke:none\" />\\n    <path\\n       transform=\"matrix(0.97020484,0,0,1.0272058,-4.0587829,-5.7503824)\"\\n       d=\"M 45.521425,84.824145 A 34.452763,33.540108 0 0 1 18.965565,45.235823 34.452763,33.540108 0 0 1 59.461557,19.132399 34.452763,33.540108 0 0 1 86.532055,58.388989 34.452763,33.540108 0 0 1 46.380085,84.9913\"\\n       id=\"path4149\"\\n       style=\"fill:#pin-secondary-color;fill-opacity:1;fill-rule:nonzero;stroke:none\" />\\n    <path\\n       transform=\"matrix(0.64629924,0,0,0.61681122,5.1261236,4.9013803)\"\\n       d=\"M 57.079416,104.60778 A 34.203297,36.623341 0 0 1 30.715842,61.380233 34.203297,36.623341 0 0 1 70.91861,32.877206 34.203297,36.623341 0 0 1 97.793096,75.742527 34.203297,36.623341 0 0 1 57.931859,104.7903\"\\n       id=\"path4184\"\\n       style=\"fill:white;fill-opacity:1;fill-rule:nonzero;stroke:none\" />';\nvar svgTag = '<svg xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns=\"http://www.w3.org/2000/svg\" height=\"300\" width=\"300\" version=\"1.1\">';\nvar c1 = 'rgb(255, 217, 102)';\nvar c2 = 'rgb(255, 238, 34)';\n\nfunction svgGroup(cell) {\n    var x= [scale,0,0,scale,cell.x-scale*pinWidth/2+0.5, cell.y-scale*pinHeight+0.5];\n    var r = '<g transform=\"matrix(' + x.join(',') +  ')\">';\n    r += pin;\n    r += '</g>';\n    return r;\n}\n\nvar infos=API.getData(\"infos\")\nvar pdbsString=value.pdbs;\npdbsString = pdbsString.toUpperCase();\nvar pdbs=pdbsString.split(/[ \\r\\n\\t,;]+/);\n\nvar cells=[];\nfor (var i=0; i<infos.length; i++) {\n    var info=infos[i];\n    var name=String(info.pdb);\n    if (name.length==4) {\n        if (pdbs.indexOf(name)>-1) {\n            cells.push(info);\n        }\n    }\n}\n\nvar finalSvg = svgTag;\nfor(i=0; i<cells.length; i++) {\n    finalSvg += svgGroup(cells[i]);\n}\nfinalSvg += '</svg>';\nfinalSvg = finalSvg.replace(/#pin-primary-color/g, c1).replace(/#pin-secondary-color/g, c2);\n\nvar listText = '';\nif(cells.length === 0)\n    listText = '(empty)';\n\nAPI.createData(\"info\",{\n    type: 'html',\n    value:'<span style=\"color: yellow;\"> ' + listText +_.pluck(cells,'pdb').join(\",\") + '</span>'\n});\n\n\n\nAPI.createData('svgList', {\n    type:'picture',\n    value: 'data:image/svg+xml;utf8,' + finalSvg\n});\nresolve(cells);"
              ]
            }
          ],
          "libs": [
            [
              {
                "lib": "lodash",
                "alias": "_"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 32,
            "top": 65
          },
          "size": {
            "width": 41,
            "height": 31
          },
          "zIndex": 0,
          "display": false,
          "title": "Module to convert a PDB list to currentPDBhover",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 41,
            "height": 54
          },
          "zIndex": 0,
          "display": true,
          "title": "Process PDB list to highlight",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 3,
      "vars_in": [
        {
          "rel": "dataobject",
          "name": "pdbsList"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Process PDB list to highlight",
      "vars_out": [
        {
          "event": "onButtonClick",
          "rel": "filteredObject",
          "jpath": [],
          "name": "PDBlist"
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/display/single_value/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "defaultvalue": [
                null
              ],
              "font": [
                null
              ],
              "fontcolor": [
                [
                  91,
                  15,
                  0,
                  1
                ]
              ],
              "fontsize": [
                "12pt"
              ],
              "align": [
                "right"
              ],
              "valign": [
                "middle"
              ],
              "sprintf": [
                null
              ],
              "sprintfOrder": [
                null
              ],
              "preformatted": [
                []
              ],
              "append": [
                []
              ],
              "maxEntries": [
                1
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 1,
            "top": 53
          },
          "size": {
            "width": 51,
            "height": 6
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 79,
            "top": 0
          },
          "size": {
            "width": 24,
            "height": 22
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 16,
            "top": 76
          },
          "size": {
            "width": 95,
            "height": 6
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        }
      },
      "id": 4,
      "vars_in": [
        {
          "rel": "value",
          "name": "info"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 21
    },
    {
      "url": "modules/types/edition/filter_editor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "script": [
                "var maps=API.getData(\"map\");\nvar largePdbs = API.getData('largePdbs').get();\nvar imageLabel = API.getData('imageLabel').get();\nvar mapsDescription = API.getData('mapsDescription').get();\nvar mapIdx = mapsDescription.indexOf(imageLabel.image);\nmapIdx = (mapIdx === -1 ? 0 : mapIdx);\nvar x=value.get().x;\nvar y=value.get().y;\nvar isLarge, toRender;\n\nfor (var i=0; i<maps.length; i++) {\n    var map=maps[i];\n    if (map.x==x && map.y==y) {\n        var pdb=map.pdb;\n        var representativePDBxy = {\n            x: map.x,\n            y: map.y,\n            name: map.pdb,\n            average: map.average[mapIdx],\n            deviation: map.deviation[mapIdx]\n        }\n         if(largePdbs[pdb]) {\n             isLarge = true;\n            toRender = {\n                type: 'png',\n                _options: {width: '100%'},\n                value: 'http://www.cheminfo.org/couch/pdb-bio-assembly/' + pdb + '/400x400.png'\n            }\n        } else {\n            toRender = {\n                type:\"pdb\",\n                url:\"http://www.cheminfo.org/couch/pdb-bio-assembly/\"+pdb+\"/\"+pdb+\".pdb1\"\n            };\n        }\n        break;\n    }\n}\n\nAPI.createData(\"representativePDB\",toRender || {type: 'pdb', value: ''});\nif(isLarge) API.createData('warningMessage', 'PDB is too big to be loaded');\nelse API.createData('warningMessage', '');\nAPI.createData('representativePDBxy', representativePDBxy || {x: x, y: y});\nAPI.createData('listInfo', \"List of proteins in clicked cell (\" +pdb + \")\");\nAPI.createData('searchInput', {\n    code: pdb\n});\nAPI.createData('displayedPDBinfo', representativePDBxy);\n\n"
              ]
            }
          ],
          "libs": [
            [
              {
                "lib": "jquery",
                "alias": "$"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 169,
            "top": 77
          },
          "size": {
            "width": 19,
            "height": 22
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 44,
            "top": 55
          },
          "size": {
            "width": 63,
            "height": 54
          },
          "zIndex": 0,
          "display": true,
          "title": "Calculate the representative for clickedCell",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 117,
            "top": 0
          },
          "size": {
            "width": 58.939999997615814,
            "height": 83.03999999761581
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "Initialisation": {
          "display": false,
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true
        }
      },
      "id": 5,
      "vars_in": [
        {
          "rel": "dataobject",
          "name": "clickedCell"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Calculate the representative for clickedCell",
      "vars_out": [
        {
          "jpath": []
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/edition/onde/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "hasButton": [
                [
                  "show"
                ]
              ],
              "button_text": [
                "Search by similarity"
              ],
              "debouncing": [
                -1
              ],
              "output": [
                "new"
              ],
              "mode": [
                "schema"
              ],
              "schemaSource": [
                "config"
              ],
              "schema": [
                "{\n    \"type\": \"object\",    \n    \"properties\": {\n        \"code\": {\n            \"type\":\"string\",\n            \"label\":\"Enter pdb code\"\n        },\n        \"maxCount\": {\n            \"type\": \"number\",\n            \"label\": \"Max Count\",\n            \"default\": 100,\n            \"step\": 0.1\n        },\n        \"maxDistance\": {\n            \"type\": \"number\",\n            \"label\": \"Max Distance\",\n            \"default\": 10000\n        }\n    }\n }"
              ],
              "onchangeFilter": [
                null
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 114,
            "top": 0
          },
          "size": {
            "width": 61,
            "height": 16
          },
          "zIndex": 0,
          "display": true,
          "title": "Sort by similarity",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 29,
            "top": 1
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 6,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "searchInput"
        }
      ],
      "actions_in": [],
      "title": "Sort by similarity",
      "vars_out": [
        {
          "event": "onFormSubmit",
          "rel": "outputValue",
          "jpath": [],
          "name": "searchParams"
        }
      ],
      "actions_out": [
        {
          "jpath": []
        }
      ],
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "var images = this.get('images');\nvar label = this.get('imageLabel').image;\nvar idx = _.findIndex(images, function(img) {\n    return String(img.label) === String(label);\n})\nif(idx > -1) {\n    this.set('png', images.getChildSync([idx]));\n}"
              ]
            }
          ],
          "libs": [
            [
              {
                "lib": "lodash",
                "alias": "_"
              }
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 53,
            "top": 0
          },
          "size": {
            "width": 52,
            "height": 37
          },
          "zIndex": 0,
          "display": true,
          "title": "Output png from selection",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 7,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "images"
        },
        {
          "rel": "inputValue",
          "name": "imageLabel"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Output png from selection",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "png",
            "png"
          ],
          "name": "png"
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "// Generate schema\nvar images = this.get('images');\nif(!Array.isArray(images)) {\n    return;\n}\n\nvar enumValues = [];\nfor(var i=0; i<images.length; i++) {\n    if(images[i].label) {\n        enumValues.push(images[i].label);\n    }\n}\n\nvar schema = {\n    type: 'object',\n    properties: {\n        image: {\n            label: 'Select image',\n            enum: enumValues,\n            type: 'string'\n        }\n    }\n}\n\nif(enumValues.length > 0) {\n    schema.properties.image.default = enumValues[0]\n}\nthis.set('schema', schema);"
              ]
            }
          ],
          "libs": [
            [
              {}
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 53,
            "top": 38
          },
          "size": {
            "width": 52,
            "height": 37
          },
          "zIndex": 0,
          "display": true,
          "title": "Create onde schema (select image)",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 8,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "images"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Create onde schema (select image)",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "schema"
          ],
          "name": "imageSchema"
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/edition/onde/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "hasButton": [
                []
              ],
              "button_text": [
                "Export"
              ],
              "debouncing": [
                0
              ],
              "output": [
                "new"
              ],
              "mode": [
                "schema"
              ],
              "schemaSource": [
                "variable"
              ],
              "schema": [
                "{\n    \"type\": \"object\",\n    \"properties\": {\n        \"abc\": {\n            \"type\":\"string\",\n            \"enum\": [\"a\",\"b\"],\n            \"default\": \"a\"   \n        }\n    }\n}"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 27,
            "top": 1
          },
          "size": {
            "width": 34,
            "height": 10
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 106,
            "top": 0
          },
          "size": {
            "width": 29,
            "height": 22
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 9,
      "vars_in": [
        {
          "rel": "schema",
          "name": "imageSchema"
        }
      ],
      "actions_in": [],
      "title": "",
      "vars_out": [
        {
          "event": "onFormSubmit",
          "rel": "outputValue",
          "jpath": [],
          "name": "imageLabel"
        }
      ],
      "actions_out": [
        {
          "jpath": []
        }
      ],
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "var scale = 0.05;\nvar pinWidth = 94;\nvar pinHeight = 128;\nvar imgHeight = 300;\nvar imgWidth = 300;\n\nvar pin = '    <path\\n       id=\"path4127\"\\n       d=\"M 46.977003,126.64334 C 46.693972,125.95584 40.813862,120.20567 36.603071,114.98067 11.655836,81.858372 -16.158365,51.082905 16.319943,13.682837 30.700637,-0.21083367 48.43303,-1.0034227 66.662563,5.4726973 117.9922,35.174601 80.828906,83.627914 56.427079,115.48067 l -9.450076,11.16267 z M 62.417383,75.872046 C 96.654166,51.387445 70.185413,4.2391813 32.569429,19.913013 21.585178,25.769872 16.134954,35.960547 15.944071,47.980664 c -0.524495,11.693153 5.685418,21.471037 15.526227,27.460808 7.055481,3.840074 10.157178,4.533661 18.145697,4.057654 5.177622,-0.308516 8.161127,-1.153847 12.801388,-3.62708 z\"\\n       style=\"fill:#pin-primary-color;fill-opacity:0.98823529\" />\\n    <path\\n       transform=\"matrix(0.87829487,0,0,1.0519028,0.55474126,-6.9952658)\"\\n       d=\"M 41.682107,89.891342 A 51.222816,41.754009 0 0 1 2.2000499,40.607923 51.222816,41.754009 0 0 1 62.407668,8.111826 51.222816,41.754009 0 0 1 102.65487,56.982272 51.222816,41.754009 0 0 1 42.958724,90.099433\"\\n       id=\"path4129\"\\n       style=\"fill:#pin-primary-color;fill-opacity:0.98823529;fill-rule:nonzero;stroke:none\" />\\n    <path\\n       transform=\"translate(0.64534523,0)\"\\n       d=\"M 43.631232,69.128546 A 26.010695,20.991087 0 0 1 23.582437,44.352182 26.010695,20.991087 0 0 1 54.15557,28.015346 26.010695,20.991087 0 0 1 74.592899,52.584095 26.010695,20.991087 0 0 1 44.279492,69.23316\"\\n       id=\"path4131\"\\n       style=\"opacity:0.34016395;fill:black;fill-opacity:0;fill-rule:nonzero;stroke:none\" />\\n    <path\\n       transform=\"translate(0.64534523,0)\"\\n       d=\"M 31.892136,114.28 A 16.655972,11.750445 0 0 1 19.053873,100.41062 16.655972,11.750445 0 0 1 38.631405,91.265547 16.655972,11.750445 0 0 1 51.718468,105.01871 16.655972,11.750445 0 0 1 32.30725,114.33856\"\\n       id=\"path4135\"\\n       style=\"fill:rgb(0,0,128);fill-opacity:0;fill-rule:nonzero;stroke:none\" />\\n    <path\\n       transform=\"matrix(0.97020484,0,0,1.0272058,-4.0587829,-5.7503824)\"\\n       d=\"M 45.521425,84.824145 A 34.452763,33.540108 0 0 1 18.965565,45.235823 34.452763,33.540108 0 0 1 59.461557,19.132399 34.452763,33.540108 0 0 1 86.532055,58.388989 34.452763,33.540108 0 0 1 46.380085,84.9913\"\\n       id=\"path4149\"\\n       style=\"fill:#pin-secondary-color;fill-opacity:1;fill-rule:nonzero;stroke:none\" />\\n    <path\\n       transform=\"matrix(0.64629924,0,0,0.61681122,5.1261236,4.9013803)\"\\n       d=\"M 57.079416,104.60778 A 34.203297,36.623341 0 0 1 30.715842,61.380233 34.203297,36.623341 0 0 1 70.91861,32.877206 34.203297,36.623341 0 0 1 97.793096,75.742527 34.203297,36.623341 0 0 1 57.931859,104.7903\"\\n       id=\"path4184\"\\n       style=\"fill:white;fill-opacity:1;fill-rule:nonzero;stroke:none\" />';\nvar svgTag = '<svg xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns=\"http://www.w3.org/2000/svg\" height=\"300\" width=\"300\" version=\"1.1\">';\nfunction svgGroup(cell) {\n    var x= [scale,0,0,scale,cell.x-scale*pinWidth/2+0.5, cell.y-scale*pinHeight+0.5];\n    var r = '<g transform=\"matrix(' + x.join(',') +  ')\">';\n    r += pin;\n    r += '</g>';\n    return r;\n}\nvar pinNames = ['representativePin', 'searchPin', 'droppedPin'];\nvar pdbNames = ['representativePDBxy', 'searchPDBxy', 'droppedMapPosition'];\nvar colors1 = ['rgb(198, 66, 66)', 'rgb(60, 110, 220)', 'rgb(85,85,85)'];\nvar colors2 = ['rgb(183,44,44)', 'rgb(11,83,148)', 'rgb(17,17,17'];\n\nfor(var i=0; i<pinNames.length; i++) {\n    if(this.variable !== pdbNames[i]) API.doAction('hide', pinNames[i]);\n    else {\n        API.doAction('show', pinNames[i]);\n        sendSvg(this.get(pdbNames[i]), pinNames[i], colors1[i], colors2[i]);\n    }\n}\n\nfunction sendSvg(xy, name, c1, c2) {\n    if(DataObject.resurrect(xy)) {\n        var finalSvg = svgTag;\n        finalSvg += svgGroup(xy);\n        finalSvg += '</svg>';\n        finalSvg = finalSvg.replace(/#pin-primary-color/g, c1).replace(/#pin-secondary-color/g, c2);\n        API.createData(name, {\n            type: 'picture',\n            value: 'data:image/svg+xml;utf8,' + finalSvg\n        });\n    }\n}\n\nfunction sendEmpty(name) {\n    API.createData(name, {\n        type:'picture',\n        value: 'data:image/svg+xml;utf8,<svg></svg>'\n    })\n}\n"
              ]
            }
          ],
          "libs": [
            [
              {}
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 177,
            "top": 2
          },
          "size": {
            "width": 35,
            "height": 43
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 108,
            "top": 55
          },
          "size": {
            "width": 67,
            "height": 54
          },
          "zIndex": 0,
          "display": true,
          "title": "Draw pins",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 10,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "representativePDBxy"
        },
        {
          "rel": "inputValue",
          "name": "searchPDBxy"
        },
        {
          "rel": "inputValue",
          "name": "droppedMapPosition"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Draw pins",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "highlight"
          ],
          "name": "highlight"
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/display/single_value/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "defaultvalue": [
                null
              ],
              "font": [
                null
              ],
              "fontcolor": [
                [
                  255,
                  242,
                  204,
                  1
                ]
              ],
              "fontsize": [
                "12pt"
              ],
              "align": [
                "left"
              ],
              "valign": [
                "top"
              ],
              "sprintf": [
                ""
              ],
              "sprintfOrder": [
                null
              ],
              "preformatted": [
                []
              ],
              "append": [
                []
              ],
              "maxEntries": [
                1
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 1,
            "top": 9
          },
          "size": {
            "width": 31,
            "height": 7
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 11,
      "vars_in": [
        {
          "rel": "value",
          "name": "representativePDBinfo"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "\nvar searchParams = this.get('searchParams');\nconsole.log('search params', searchParams);\n\nvar pdb=searchParams.code.toUpperCase();\n\nvar originalPdb = pdb;\nvar maxCount = searchParams ? searchParams.maxCount || 100 : 100;\nvar maxDistance = searchParams ? searchParams.maxDistance || 10000 : 10000;\nvar largePdbs = API.getData('largePdbs').get();\nvar infos=API.getData(\"infos\");\nvar isLarge;\nvar indexes = [];\nfor (var i=0; i<infos.length; i++) {\n    if (infos[i].pdb==pdb) {\n        var searchPDBxy = {\n            x: infos[i].x,\n            y: infos[i].y,\n            name: pdb\n        };\n        if(largePdbs[pdb]) isLarge = true;\n        var searchPdbUrl = 'http://www.cheminfo.org/couch/pdb-bio-assembly/' + pdb + '/' + pdb + '.pdb1';\n        \n        indexes=infos[i].i;\n        break;\n    }\n}\n\nvar pdbs = [];\nif(indexes.length > 0) {\n    pdbs=new Array(infos.length);\n    for (var i=0; i<infos.length; i++) {\n        var info=infos[i];\n        var distance=0;\n        var indexes2=info.i;\n        for (var j=0; j<indexes.length; j++) {\n            distance+=Math.abs(indexes2[j]-indexes[j]);\n        }\n        var pdb=info.pdb;\n        var toRender = {\n            type: 'png',\n            value: 'http://www.cheminfo.org/couch/pdb-bio-assembly/' + pdb + \"/400x400.png\"\n        };\n        \n        pdbs[i]={\n            code: info.pdb,\n            pdb: toRender,\n            distance: distance,\n            pdbSite: {\n                type:\"openLink\",\n                value: \"http://www.rcsb.org/pdb/explore/explore.do?structureId=\" + pdb\n            },\n            inJsmol: {\n                type: 'openLink',\n                value: 'http://visualizer.epfl.ch/cheminfo/home/index.html?viewURL=%2Fcheminfo%2F4361c134eb36eff59b0388449f57ba8e%2Fview.json&pdbID=' + pdb\n            }\n        }\n    }\n    pdbs = pdbs.filter(function(pdb) {\n        return pdb.distance < maxDistance;\n    });\n    \n    \n    pdbs.sort(function(a,b) {\n        return a.distance-b.distance;\n    });\n    \n    pdbs = pdbs.filter(function(pdb,i) {\n        return i < maxCount;\n    });\n    var counter = 0;\n    pdbs = pdbs.map(function(pdb) {\n        pdb.rank = ++counter;\n        return pdb;\n    });\n}\n\nsetTimeout(function() {\n    API.doAction('showDistance', 'element.distance');\n}, 1000);\n\nthis.set('pdbsInCell', pdbs);\nthis.set('searchPDBxy', searchPDBxy);\nif(!isLarge) {\n    console.log(searchPdbUrl);\n    this.set('searchPDB', {\n        type: 'pdb',\n        url: searchPdbUrl\n    });\n    API.createData('warningMessage', '');\n}\nelse {\n    this.set('searchPDB', {\n        type: 'pdb',\n        value: ''\n    });\n    API.createData('warningMessage','PDB is too big to be loaded');\n}\n\n\nAPI.createData('listInfo', \"List of proteins similar to: \" + (indexes.length > 0 ? originalPdb: ''));\n\n"
              ]
            }
          ],
          "libs": [
            [
              {}
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 65,
            "top": 79
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 63,
            "height": 78
          },
          "zIndex": 0,
          "display": true,
          "title": "Search from search form",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 12,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "searchParams"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Search from search form",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "pdbsInCell"
          ],
          "name": "pdbsInCell"
        },
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "searchPDBxy"
          ],
          "name": "searchPDBxy"
        },
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "searchPDB"
          ],
          "name": "searchPDB"
        },
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "searchPDBxy"
          ],
          "name": "displayedPDBinfo"
        }
      ],
      "actions_out": [],
      "zindex": 14
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "API.loading(\"download\", \"Fetching PDBs and preparing zip file\");\n\nsetTimeout(function() {\n    var pdbs = API.getData('pdbsInCell');\n    if(!pdbs || pdbs.length === 0) return;\n    \n    \n    var zip = new JSZip();\n    var pdbFolder = zip.folder('pdb');\n    var prom = [];\n    for(var i=0; i<pdbs.length; i++) {\n        var pdb = {\n            type: 'pdb',\n            url: \"http://www.cheminfo.org/couch/pdb-bio-assembly/\" + pdbs[i].code + '/' + pdbs[i].code + '.pdb1'\n        }\n        prom.push(DataObject.check(pdb, true).get(true));\n    }\n    \n    Promise.all(prom).then(function(files) {\n        for(var i=0; i<files.length; i++) {\n            var code = String(pdbs[i].code) + '.pdb';\n            pdbFolder.file(code, String(files[i]));\n        }\n        var content = zip.generate({type:\"blob\"});\n        fileSaver(content, 'pdb.zip');\n        API.stopLoading(\"download\");\n    })\n},100);"
              ]
            }
          ],
          "libs": [
            [
              {
                "lib": "file-saver",
                "alias": "fileSaver"
              },
              {
                "lib": "jszip",
                "alias": "JSZip"
              }
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Download zip"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 164,
            "top": 14
          },
          "size": {
            "width": 14,
            "height": 7
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 13,
      "vars_in": [
        {}
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [
        {
          "jpath": []
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "if(this.defined !== 3) return;\nvar hoverCell = this.get('hoverCell');\nvar maps = this.get('map');\nvar imageLabel = API.getData('imageLabel').get();\nvar mapsDescription = API.getData('mapsDescription').get();\nvar mapIdx = mapsDescription.indexOf(imageLabel.image);\nvar x = hoverCell.x;\nvar y = hoverCell.y;\nfor (var i=0; i<maps.length; i++) {\n    var map=maps[i];\n    if (map.x==x && map.y==y) {\n        var pdb=map.pdb;\n        var representativePDBimg = {\n            type: \"png\",\n            value: \"http://www.cheminfo.org/couch/pdb-bio-assembly/\" + pdb + '/400x400.png'\n        }\n        var hoverRepresentativePDB = {\n            name: map.pdb,\n            x: map.x,\n            y: map.y,\n            average: map.average[mapIdx],\n            deviation: map.deviation[mapIdx]\n        }\n        break;\n    }\n}\nif(representativePDBimg === undefined)\n    representativePDBimg = {\n        type: 'png',\n        value: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2NkAAIAAAoAAggA9GkAAAAASUVORK5CYII='\n    }\nthis.set('prepresentativePDBimg', representativePDBimg);\n    \nif(hoverRepresentativePDB) {\n    this.set('hoverPDB', hoverRepresentativePDB);\n}\nelse {\n    this.set('hoverPDB', null)\n}"
              ]
            }
          ],
          "libs": [
            [
              {}
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 81,
            "top": 88
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "Representative for hoverCell",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 42,
            "top": 0
          },
          "size": {
            "width": 68,
            "height": 54
          },
          "zIndex": 0,
          "display": true,
          "title": "Representative for hoverCell",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "Representative for hoverCell",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "Representative for hoverCell",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 14,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "hoverCell"
        },
        {
          "rel": "inputValue",
          "name": "map"
        },
        {
          "rel": "inputValue",
          "name": "imageLabel"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Representative for hoverCell",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "prepresentativePDBimg"
          ],
          "name": "representativePDBimg"
        },
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "hoverPDB"
          ],
          "name": "representativeHoverPDB"
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/display/single_value/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "defaultvalue": [
                null
              ],
              "font": [
                null
              ],
              "fontcolor": [
                [
                  0,
                  0,
                  0,
                  1
                ]
              ],
              "fontsize": [
                "14pt"
              ],
              "align": [
                "left"
              ],
              "valign": [
                null
              ],
              "sprintf": [
                null
              ],
              "sprintfOrder": [
                null
              ],
              "preformatted": [
                []
              ],
              "append": [
                []
              ],
              "maxEntries": [
                1
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 116,
            "top": 18
          },
          "size": {
            "width": 39,
            "height": 10
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 15,
      "vars_in": [
        {
          "rel": "value",
          "name": "listInfo"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/display/single_value/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "defaultvalue": [
                null
              ],
              "font": [
                null
              ],
              "fontcolor": [
                [
                  0,
                  0,
                  0,
                  1
                ]
              ],
              "fontsize": [
                null
              ],
              "align": [
                null
              ],
              "valign": [
                null
              ],
              "sprintf": [
                null
              ],
              "sprintfOrder": [
                null
              ],
              "preformatted": [
                []
              ],
              "append": [
                []
              ],
              "maxEntries": [
                1
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 0,
            "top": 59
          },
          "size": {
            "width": 45,
            "height": 33
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            0,
            0,
            0,
            1
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 29,
            "height": 23
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 168,
            "top": 22
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 114,
            "top": 79
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 16,
      "vars_in": [
        {
          "rel": "value",
          "name": "representativePDBimg"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 24
    },
    {
      "url": "modules/types/client_interaction/dragdrop/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "label": [
                "Drop your pdb file here"
              ],
              "dragoverlabel": [
                null
              ],
              "hoverlabel": [
                null
              ],
              "getusermedia": [
                []
              ],
              "capture": [
                "none"
              ]
            }
          ],
          "vars": [
            [
              {
                "filter": "ext",
                "extension": "*",
                "filetype": "text",
                "type": "pdb",
                "variable": "file"
              }
            ]
          ],
          "string": [
            [
              {
                "type": "string",
                "filter": "text/plain",
                "variable": "str"
              }
            ]
          ],
          "photo": [
            [
              {
                "variable": "photo"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 62,
            "top": 0
          },
          "size": {
            "width": 51,
            "height": 4
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            239,
            235,
            227,
            1
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 104,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 22
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 189,
            "top": 22
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 17,
      "title": "",
      "vars_out": [
        {
          "event": "onRead",
          "rel": "data",
          "jpath": [
            "file",
            "content"
          ],
          "name": "droppedPdb"
        }
      ],
      "vars_in": [],
      "actions_in": [
        {}
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "var pdb = this.get('droppedPdb');\nvar protein = pdbMap.parse(pdb);\nvar fingerprint = pdbMap.fingerprint(protein.atoms);\nvar position = pdbMap.mapPosition(fingerprint);\nposition.name = 'Dropped PDB';\n\nthis.set('position', position);\nthis.set('fingerprint', fingerprint);\n"
              ]
            }
          ],
          "libs": [
            [
              {
                "lib": "pdbMap",
                "alias": "pdbMap"
              }
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 176,
            "top": 21
          },
          "size": {
            "width": 54,
            "height": 56
          },
          "zIndex": 0,
          "display": false,
          "title": "Process dropped file",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 55
          },
          "size": {
            "width": 43,
            "height": 54
          },
          "zIndex": 0,
          "display": true,
          "title": "Calculate fingerprint and map position of dropped pdb",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 18,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "droppedPdb"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Calculate fingerprint and map position of dropped pdb",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "position"
          ],
          "name": "droppedMapPosition"
        },
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "fingerprint"
          ],
          "name": "fingerprint"
        },
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "position"
          ],
          "name": "displayedPDBinfo"
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/display/template-twig/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "template": [
                "<style>\n    .cell-summary {\n        color: white;\n        font-size: 20px;\n        text-align: right;\n    }\n</style>\n<div class=\"cell-summary\">\n    {% if representativeHoverPDB %}\n    <p>Hovered</p>\nName: {{representativeHoverPDB.name}} <br/>\nPosition: {{representativeHoverPDB.x}}, {{representativeHoverPDB.y}} <br/>\nAvg, stdev: {{representativeHoverPDB.average}}, {{representativeHoverPDB.deviation}}\n{% endif %}\n</div>"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 8,
            "top": 67
          },
          "size": {
            "width": 52,
            "height": 17
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            0,
            0,
            0,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 191,
            "top": 1
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 19,
      "vars_in": [
        {
          "rel": "value",
          "name": "representativeHoverPDB"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 25
    },
    {
      "url": "modules/types/client_interaction/button_action/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "toggle": [
                "toggle"
              ],
              "label": [
                "Action"
              ],
              "onLabel": [
                "Hide list"
              ],
              "offLabel": [
                "Show list"
              ],
              "onColor": [
                [
                  0,
                  0,
                  0,
                  1
                ]
              ],
              "offColor": [
                [
                  0,
                  0,
                  0,
                  1
                ]
              ],
              "startState": [
                "on"
              ],
              "text": [
                "svgList"
              ],
              "askConfirm": [
                []
              ],
              "confirmText": [
                "Are you sure?"
              ],
              "okLabel": [
                "Ok"
              ],
              "cancelLabel": [
                "Cancel"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 52,
            "top": 54
          },
          "size": {
            "width": 13,
            "height": 6
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 20,
      "vars_in": [],
      "actions_in": [
        {}
      ],
      "title": "",
      "zindex": 22,
      "vars_out": [],
      "actions_out": [
        {
          "event": "onToggleOn",
          "rel": "actionText",
          "jpath": [],
          "name": "show"
        },
        {
          "event": "onToggleOff",
          "rel": "actionText",
          "jpath": [],
          "name": "hide"
        }
      ]
    },
    {
      "url": "modules/types/display/single_value/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "defaultvalue": [
                null
              ],
              "font": [
                null
              ],
              "fontcolor": [
                [
                  0,
                  0,
                  0,
                  1
                ]
              ],
              "fontsize": [
                null
              ],
              "align": [
                null
              ],
              "valign": [
                null
              ],
              "sprintf": [
                null
              ],
              "sprintfOrder": [
                null
              ],
              "preformatted": [
                []
              ],
              "append": [
                []
              ],
              "maxEntries": [
                1
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 32,
            "top": 59
          },
          "size": {
            "width": 29,
            "height": 33
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            0,
            0,
            0,
            1
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 29,
            "height": 23
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 168,
            "top": 22
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 114,
            "top": 79
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 21,
      "vars_in": [
        {}
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/display/template-twig/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "template": [
                "<span style=\"color: black; font-size: 18px;\">{{displayedPDBinfo.name}} </span>"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 63,
            "top": 8
          },
          "size": {
            "width": 13,
            "height": 6
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 22,
      "vars_in": [
        {
          "rel": "value",
          "name": "displayedPDBinfo"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 22
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "var indexes = this.get('fingerprint');\nvar infos = API.getData('infos');\nvar searchParams = API.getData('searchParams');\nvar maxCount = searchParams ? searchParams.maxCount || 100 : 100;\nvar maxDistance = searchParams ? searchParams.maxDistance || 10000 : 10000;\nvar pdbs = [];\n\nif(indexes.length > 0) {\n    pdbs=new Array(infos.length);\n    for (var i=0; i<infos.length; i++) {\n        var info=infos[i];\n        var distance=0;\n        var indexes2=info.i;\n        for (var j=0; j<infos[0].i.length; j++) {\n            distance+=Math.abs(indexes2[j]-indexes[j]);\n        }\n        var pdb=info.pdb;\n        var toRender = {\n            type: 'png',\n            value: 'http://www.cheminfo.org/couch/pdb-bio-assembly/' + pdb + \"/400x400.png\"\n        };\n        pdbs[i]={\n            code: info.pdb,\n            pdb: toRender,\n            distance: distance,\n            pdbSite: {\n                type:\"openLink\",\n                value: \"http://www.rcsb.org/pdb/explore/explore.do?structureId=\" + pdb\n            },\n            inJsmol: {\n                type: 'openLink',\n                value: 'http://visualizer.epfl.ch/cheminfo/home/index.html?viewURL=%2Fcheminfo%2F4361c134eb36eff59b0388449f57ba8e%2Fview.json&pdbID=' + pdb\n            }\n        }\n    }\n    pdbs = pdbs.filter(function(pdb) {\n        return pdb.distance < maxDistance;\n    });\n    \n    \n    pdbs.sort(function(a,b) {\n        return a.distance-b.distance;\n    });\n    \n    pdbs = pdbs.filter(function(pdb,i) {\n        return i < maxCount;\n    });\n    var counter = 0;\n    pdbs = pdbs.map(function(pdb) {\n        pdb.rank = ++counter;\n        return pdb;\n    });\n}\n\nsetTimeout(function() {\n    API.doAction('showDistance', 'element.distance');\n}, 1000);\n\nthis.set('pdbsInCell', pdbs);\nthis.set('listInfo', 'List of proteins similar to dropped PDB')\nAPI.createData('warningMessage', '');\n\n"
              ]
            }
          ],
          "libs": [
            [
              {}
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 195,
            "top": 26
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 64,
            "top": 0
          },
          "size": {
            "width": 58,
            "height": 78
          },
          "zIndex": 0,
          "display": true,
          "title": "Search based on dropped pdb",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 23,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "fingerprint"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Search based on dropped pdb",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "pdbsInCell"
          ],
          "name": "pdbsInCell"
        },
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "listInfo"
          ],
          "name": "listInfo"
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "// we will find all the PDFs in this cell\n\nvar infos=API.getData(\"infos\").get();\nvar largePdbs = API.getData('largePdbs').get();\nvar clickedCell = this.get('clickedCell');\nvar x = clickedCell.x\nvar y = clickedCell.y;\n\nvar result=[];\nvar count = 0;\nfor (var i=0; i<infos.length; i++) {\n    var info=infos[i];\n    if (info.x==x && info.y==y) {\n        count++;\n        var pdb=info.pdb;\n        var toRender = {\n            type: 'png',\n            value: 'http://www.cheminfo.org/couch/pdb-bio-assembly/' + pdb + \"/400x400.png\"\n        }\n    \n        result.push(\n            {\n                pdb: toRender,\n                code: pdb,\n                pdbSite: {\n                    type:\"openLink\",\n                    value: \"http://www.rcsb.org/pdb/explore/explore.do?structureId=\" + pdb\n                },\n                inJsmol: {\n                    type: 'openLink',\n                    value: 'http://visualizer.epfl.ch/cheminfo/home/index.html?viewURL=%2Fcheminfo%2F4361c134eb36eff59b0388449f57ba8e%2Fview.json&pdbID=' + pdb\n                }\n        });\n    }\n}\n\nsetTimeout(function() {\n    API.doAction('hideDistance', 'element.distance');\n}, 1000);\n\nthis.set('pdbsInCell', result);\n\n"
              ]
            }
          ],
          "libs": [
            [
              {}
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 197,
            "top": 34
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 111,
            "top": 0
          },
          "size": {
            "width": 64,
            "height": 54
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 24,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "clickedCell"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "pdbsInCell"
          ],
          "name": "pdbsInCell"
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/display/single_value/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "defaultvalue": [
                null
              ],
              "font": [
                null
              ],
              "fontcolor": [
                [
                  224,
                  102,
                  102,
                  1
                ]
              ],
              "fontsize": [
                "14pt"
              ],
              "align": [
                "left"
              ],
              "valign": [
                null
              ],
              "sprintf": [
                null
              ],
              "sprintfOrder": [
                null
              ],
              "preformatted": [
                []
              ],
              "append": [
                []
              ],
              "maxEntries": [
                1
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 63,
            "top": 67
          },
          "size": {
            "width": 38,
            "height": 7
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            0,
            255,
            0,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 25,
      "vars_in": [
        {
          "rel": "value",
          "name": "warningMessage"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 28
    },
    {
      "url": "modules/types/display/single_value/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "defaultvalue": [
                null
              ],
              "font": [
                null
              ],
              "fontcolor": [
                [
                  255,
                  255,
                  255,
                  1
                ]
              ],
              "fontsize": [
                null
              ],
              "align": [
                null
              ],
              "valign": [
                null
              ],
              "sprintf": [
                null
              ],
              "sprintfOrder": [
                null
              ],
              "preformatted": [
                []
              ],
              "append": [
                []
              ],
              "maxEntries": [
                1
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 62,
            "top": 5
          },
          "size": {
            "width": 51,
            "height": 65
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            1
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 184,
            "top": 11
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 26,
      "vars_in": [
        {
          "rel": "value",
          "name": "displayPdb"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 0
    },
    {
      "url": "modules/types/edition/onde/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "hasButton": [
                []
              ],
              "button_text": [
                "Export"
              ],
              "debouncing": [
                0
              ],
              "output": [
                "new"
              ],
              "mode": [
                "schema"
              ],
              "schemaSource": [
                "config"
              ],
              "schema": [
                "{\n    \"type\": \"object\",\n    \"properties\": {\n        \"mode\": {\n            \"type\": \"string\",\n            \"label\": \"mode\",\n            \"enum\": [\"cartoon\", \"lines\", \"sline\", \"lineTrace\", \"tube\", \"trace\"],\n            \"default\": \"cartoon\"\n        }\n    }\n}"
              ],
              "onchangeFilter": [
                null
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 95,
            "top": 67
          },
          "size": {
            "width": 17,
            "height": 7
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 27,
      "vars_in": [
        {}
      ],
      "actions_in": [],
      "title": "",
      "vars_out": [
        {
          "event": "onFormSubmit",
          "rel": "outputValue",
          "jpath": [],
          "name": "pdbMode"
        }
      ],
      "actions_out": [
        {
          "jpath": []
        }
      ],
      "zindex": 29
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "if(this.defined !== 2) {\n    return;\n}\nvar that = this;\nvar storeName = 'pdbExplorer';\nvar varName = 'map';\nvar mapUrl = 'map.json';\nsetAsync();\n\n\nfunction doRequest () {\n    if(API.cache.request) return done();\n    \n    API.cache.request = true;\n    API.loading('pdbexplorer', 'Loading and initializing, please hang on');\n    var req = superagent.get(mapUrl).end(function (err, res) {\n        console.log('map.json done'); LRU.store(storeName, varName, res.text);\n        goOn(res.body);\n    });\n}\n\nfunction isDone() {\n    API.stopLoading('pdbexplorer');\n    done();\n}\n\nif (!LRU.exists(storeName)) {\n    LRU.create(storeName, 100, 200);\n}\n\ndoRequest();\n// Promise.resolve(LRU.get(storeName, varName)).then(function (entry) {\n//     console.log('entry', entry);\n//     if(entry.data) {\n//         console.log(entry.timeout);\n//         if(Date.now() - 24*60*60*1000 > entry.timeout) {\n//             console.log('data timed out');\n//         }\n//         console.log('from store');\n//         goOn(JSON.parse(entry.data));\n//     } else {\n//         isDone();\n//     }\n//     }, doRequest);\n\nfunction goOn(value) {\n    var size=300;\n    var pdbsize = that.get('pdbsize');\n    if(typeof pdbsize === 'string') {\n        pdbsize = JSON.parse(pdbsize);    \n    }\n    var nopdb = that.get('nopdb').get();\n    if(typeof nopdb === 'string') {\n        nopdb = JSON.parse(nopdb);\n    }\n    \n    pdbsize = _.pluck(pdbsize.rows, 'id');\n    nopdb = _.pluck(nopdb.rows, 'id');\n    var largePdbs = pdbsize.concat(nopdb);\n    var lpdb = {};\n    for(var i=0; i<largePdbs.length; i++) {\n        lpdb[largePdbs[i]] = true;\n    }\n    API.createData('largePdbs', lpdb);\n    var mapsDescription=value.mapDescription;\n    API.createData(\"models\", value.models);\n    API.createData(\"mapsDescription\", mapsDescription);\n    API.createData('imageLabel', {image:mapsDescription[0]});\n    \n    var numberImages=value.mapDescription.length;\n    \n    \n    var maps=value.map;\n    function createImage(maps, colorIndex, size) {\n        var factor=1; // what is the size of each pixel\n        var canvas = document.createElement('canvas');\n        canvas.height=size*factor; canvas.width=size*factor;\n        var context = canvas.getContext(\"2d\");\n        var imageData=context.createImageData(size*factor, size*factor);\n        var data=imageData.data;\n        for (var i=0; i<(size*size*factor*factor); i++) {\n            data[i*4+0]=0; // Red\n            data[i*4+1]=0; // Green\n            data[i*4+2]=0; // Blue\n            data[i*4+3]=255;\n        }\n        for (var i=0; i<maps.length; i++) {\n            var map=maps[i];\n            var color=map.colors[colorIndex];\n            for (var j=0; j<factor; j++) {\n                for (var k=0; k<factor; k++) {\n                    var index=((map.y*factor+j)*(factor*size))+map.x*factor;\n                    data[index*4+0+k*4]=parseInt(color.substr(0,2),16); // Red\n                    data[index*4+1+k*4]=parseInt(color.substr(2,2),16); // Green\n                    data[index*4+2+k*4]=parseInt(color.substr(4,2),16); // Blue\n                    data[index*4+3+k*4]=255; // alpha (transparency)\n                }\n            }\n        }\n        context.putImageData(imageData, 0, 0); // at coords 0,0\n        return canvas.toDataURL(\"image/png\");\n    }\n    \n    var images=[];\n    for (var i=0; i<numberImages; i++) {\n        var image={};\n        images.push(image);\n        image.label=mapsDescription[i];\n        image.png={\n            type:\"png\",\n            value:createImage(maps, i, size)\n        }\n    }\n    API.createData(\"images\",images);\n    \n    \n    var infos=value.infos;\n    var infoCounter={};\n    for (var i=0; i<infos.length; i++) {\n        var info=infos[i];\n        infoCounter[info.x+\"-\"+info.y] ? infoCounter[info.x+\"-\"+info.y]++ : infoCounter[info.x+\"-\"+info.y]=1;\n    }\n    API.createData(\"infos\", infos);\n    \n    \n    for (var i=0; i<maps.length; i++) {\n        var map=maps[i];\n        map.counter=infoCounter[map.x+\"-\"+map.y];\n    }\n    API.createData(\"map\", maps);\n    \n    var image=images[0];\n    API.createData(\"png\", image.png);\n    API.createData(\"mapLabel\", image.label);\n    \n    API.createData(\"info\",{\n        type: 'html',\n        value:'<span style=\"color: yellow;\"> (empty) </span>'\n    });\n    isDone();\n}\n\n"
              ]
            }
          ],
          "libs": [
            [
              {
                "lib": "lodash",
                "alias": "_"
              },
              {
                "lib": "superagent",
                "alias": "superagent"
              },
              {
                "lib": "src/util/lru",
                "alias": "LRU"
              }
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 1
          },
          "size": {
            "width": 52,
            "height": 73
          },
          "zIndex": 0,
          "display": true,
          "title": "Init script",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 28,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "pdbsize"
        },
        {
          "rel": "inputValue",
          "name": "nopdb"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Init script",
      "vars_out": [
        {
          "jpath": []
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "var pdb;\nvar type;\n\nif(this.variable === 'droppedPdb' || this.variable === 'representativePDB' || this.variable === 'searchPDB') {\n    pdb = this.get(this.variable);\n    if(typeof pdb === 'string' && pdb.endsWith('png')) type = 'png'\n    console.log(this.variable);\n}\n\nelse {\n    pdb = API.getData('displayPdb');\n    if(pdb !== undefined) pdb = DataObject.resurrect(pdb);\n}\n\nvar displayPdb = { type: type || 'pdb' };\nif(pdb.url) displayPdb.url = pdb.url;\nelse if(pdb.value) displayPdb.value = pdb.value;\nelse displayPdb.value = pdb;\n\nif(type === 'png') {\n    displayPdb._options = {css: {width: '100%'}}\n} else {\n    displayPdb._options = this.get('pdbMode') || {};    \n}\n\n\nthis.set('displayPdb', displayPdb);"
              ]
            }
          ],
          "libs": [
            [
              {}
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 176,
            "top": 21
          },
          "size": {
            "width": 67,
            "height": 34
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 176,
            "top": 0
          },
          "size": {
            "width": 51,
            "height": 54
          },
          "zIndex": 0,
          "display": true,
          "title": "Generate displayed pdb with options",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 29,
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "representativePDB"
        },
        {
          "rel": "inputValue",
          "name": "droppedPdb"
        },
        {
          "rel": "inputValue",
          "name": "pdbMode"
        },
        {
          "rel": "inputValue",
          "name": "searchPDB"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Generate displayed pdb with options",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "displayPdb"
          ],
          "name": "displayPdb"
        }
      ],
      "actions_out": [],
      "zindex": 1
    },
    {
      "url": "modules/types/edition/slick_grid/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "slickCheck": [
                [
                  "enableCellNavigation",
                  "rowNumbering",
                  "forceFitColumns",
                  "highlightScroll",
                  "backToTop"
                ]
              ],
              "autoColumns": [
                []
              ],
              "toolbar": [
                []
              ],
              "colorjpath": [
                []
              ],
              "slick.defaultColumnWidth": [
                null
              ],
              "slick.rowHeight": [
                "310"
              ],
              "slick.selectionModel": [
                "row"
              ],
              "filterRow": [
                null
              ],
              "justInTimeFilter": [
                []
              ]
            }
          ],
          "cols": [
            [
              {
                "name": "Rank",
                "jpath": [
                  "rank"
                ],
                "editor": "none",
                "formatter": "typerenderer",
                "width": 33
              },
              {
                "name": "Code",
                "jpath": [
                  "code"
                ],
                "editor": "none",
                "formatter": "typerenderer",
                "width": 42
              },
              {
                "name": "pdb",
                "jpath": [
                  "pdb"
                ],
                "editor": "none",
                "formatter": "typerenderer",
                "width": 387
              },
              {
                "name": "pdb.org",
                "jpath": [
                  "pdbSite"
                ],
                "editor": "none",
                "formatter": "typerenderer",
                "width": 46
              },
              {
                "name": "Jsmol",
                "jpath": [
                  "inJsmol"
                ],
                "editor": "none",
                "formatter": "typerenderer",
                "width": 44
              },
              {
                "name": "Distance",
                "jpath": [
                  "distance"
                ],
                "editor": "none",
                "formatter": "typerenderer",
                "width": 53
              }
            ]
          ],
          "groupings": [
            [
              {
                "getter": []
              }
            ]
          ],
          "actionOutButtons": [
            [
              {}
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 114,
            "top": 21
          },
          "size": {
            "width": 61,
            "height": 71
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 30,
      "vars_in": [
        {
          "rel": "list",
          "name": "pdbsInCell"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [
        {
          "jpath": []
        }
      ],
      "actions_out": [
        {
          "event": "onSelect",
          "rel": "row",
          "jpath": [],
          "name": "clickedRow"
        }
      ],
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/code_executor/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "display": [
                [
                  "editor",
                  "buttons"
                ]
              ],
              "execOnLoad": [
                []
              ],
              "script": [
                "\nconsole.log(this);\nthis.set('searchInput', {\n    code: this.action.value.code\n});\n\n"
              ]
            }
          ],
          "libs": [
            [
              {}
            ]
          ],
          "buttons": [
            [
              {
                "name": "button1",
                "label": "Execute"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 191,
            "top": 21
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 176,
            "top": 55
          },
          "size": {
            "width": 49,
            "height": 54
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 31,
      "vars_in": [
        {}
      ],
      "actions_in": [
        {
          "rel": "execute",
          "name": "clickedRow"
        }
      ],
      "title": "",
      "vars_out": [
        {
          "event": "onScriptEnded",
          "rel": "outputValue",
          "jpath": [
            "searchInput"
          ],
          "name": "searchInput"
        }
      ],
      "actions_out": [],
      "zindex": 0
    },
    {
      "url": "modules/types/display/template-twig/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "template": [
                "<div style=\"text-align: right\">\n    {% if displayedPDBinfo.name %}\n    <a style=\"color: blue; font-size: 16px;\" href=\"#\" onclick=\"window.open('http://visualizer.epfl.ch/cheminfo/home/index.html?viewURL=%2Fcheminfo%2F4361c134eb36eff59b0388449f57ba8e%2Fview.json&pdbID={{displayedPDBinfo.name}}', 'jsmol', 'status=no,height=600,width=1600,resizable=yes,toolbar=no,menubar=no,scrollbars=no,location=no,directories=no');\">View in jsmol</a>\n    {% endif %}\n</div>"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 101,
            "top": 8
          },
          "size": {
            "width": 11,
            "height": 5
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 28,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 32,
      "vars_in": [
        {
          "rel": "value",
          "name": "displayedPDBinfo"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": [],
      "zindex": 32
    },
    {
      "url": "modules/types/display/template-twig/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "template": [
                "<b><a target=\"_blank\" style=\"font-size: 16px;\" href=\"http://www.cheminfo.org/pdbexplorer/help.html\">Help Page</a></b>"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 1,
            "top": 2
          },
          "size": {
            "width": 19,
            "height": 6
          },
          "zIndex": 0,
          "display": true,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        },
        "similar": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "similar"
        },
        "CalculateSimilarity": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "CalculateSimilarity"
        },
        "Initialisation": {
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 20,
            "height": 20
          },
          "zIndex": 0,
          "display": false,
          "title": "",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Initialisation"
        }
      },
      "id": 33,
      "vars_in": [
        {}
      ],
      "actions_in": [
        {}
      ],
      "title": "",
      "vars_out": [],
      "actions_out": []
    }
  ],
  "variables": [
    {
      "varname": "pdbsize",
      "jpath": [
        ""
      ],
      "url": "http://www.cheminfo.org/couch/pdb-bio-assembly/_design/query/_view/pdbsize?startkey=2000000"
    },
    {
      "varname": "nopdb",
      "jpath": [
        ""
      ],
      "url": "http://www.cheminfo.org/couch/pdb-bio-assembly/_design/query/_view/pdbsize?startkey=null&endkey=null"
    }
  ],
  "pouchvariables": [
    {}
  ],
  "configuration": {
    "title": "PDB explorer"
  },
  "actionscripts": [
    {
      "sections": {},
      "groups": {
        "action": [
          {
            "name": [
              "clearSearch"
            ],
            "script": [
              "API.createData('searchPDBxy', 0);"
            ]
          }
        ]
      }
    }
  ],
  "crons": [
    {}
  ],
  "couch_replication": [
    {
      "sections": {},
      "groups": {
        "couch": [
          [
            {
              "direction": "both",
              "continuous": []
            }
          ]
        ]
      }
    }
  ],
  "init_script": [
    {
      "sections": {},
      "groups": {
        "general": [
          {
            "script": [
              ""
            ]
          }
        ]
      }
    }
  ],
  "custom_filters": [
    {
      "sections": {
        "modules": [
          {
            "sections": {},
            "groups": {
              "modules": [
                [
                  {}
                ]
              ]
            }
          }
        ],
        "filtersLib": [
          {
            "sections": {},
            "groups": {
              "filters": [
                [
                  {}
                ]
              ]
            }
          }
        ],
        "filters": [
          {
            "sections": {},
            "groups": {
              "filter": [
                {
                  "name": [
                    null
                  ],
                  "script": [
                    null
                  ]
                }
              ],
              "libs": [
                [
                  {}
                ]
              ]
            }
          }
        ]
      },
      "groups": {}
    }
  ],
  "actionfiles": [
    {
      "sections": {},
      "groups": {
        "action": [
          [
            {}
          ]
        ]
      }
    }
  ],
  "custom_modules": [
    {
      "sections": {},
      "groups": {
        "modules": [
          [
            {}
          ]
        ],
        "modulesUrl": [
          [
            {}
          ]
        ]
      }
    }
  ],
  "aliases": [
    {
      "path": "http://www.lactame.com/lib/pdb-map/1.1.1/pdb-map",
      "alias": "pdbMap"
    }
  ]
}